import{K as N,r as S,m as f,u as O,c as r,b as t,d as i,H as o,A as p,w as u,f as m,o as c,h as b,F as w,D,I as $,L as q,E as v}from"./index-wTkU4Sw2.js";const A=N("challenges",()=>{const _=S([{id:"challenge_001",title:"ä¸€å‘¨æ— å¤–å–æŒ‘æˆ˜",description:"è¿ç»­7å¤©ä¸ç‚¹å¤–å–ï¼Œè‡ªå·±åšé¥­æˆ–é€‰æ‹©å ‚é£Ÿ",type:"daily",duration:7,difficulty:"medium",participants:1234,reward:{points:200,badge:{id:"badge_002",name:"ä½ç¢³é¥®é£Ÿ",icon:"ğŸ½ï¸"}},icon:"ğŸ±",color:"#10b981"},{id:"challenge_002",title:"ç»¿è‰²å‡ºè¡Œæœˆ",description:"ä¸€ä¸ªæœˆå†…ä¸»è¦ä½¿ç”¨å…¬å…±äº¤é€šã€éª‘è¡Œæˆ–æ­¥è¡Œ",type:"monthly",duration:30,difficulty:"hard",participants:856,reward:{points:500,badge:{id:"badge_003",name:"ç»¿è‰²å…ˆé”‹",icon:"ğŸš´"}},icon:"ğŸš‡",color:"#3b82f6"},{id:"challenge_003",title:"èŠ‚èƒ½è¾¾äºº",description:"è¿ç»­ä¸€å‘¨æ¯æ—¥ç”¨ç”µé‡ä½äº5åº¦",type:"daily",duration:7,difficulty:"easy",participants:2103,reward:{points:100,badge:{id:"badge_004",name:"èŠ‚èƒ½å«å£«",icon:"ğŸ’¡"}},icon:"âš¡",color:"#f59e0b"},{id:"challenge_004",title:"ç´ é£Ÿä¸»ä¹‰è€…",description:"åšæŒä¸€å‘¨åªåƒç´ é£Ÿ",type:"daily",duration:7,difficulty:"medium",participants:654,reward:{points:150,badge:{id:"badge_005",name:"ç´ é£Ÿè¾¾äºº",icon:"ğŸ¥¬"}},icon:"ğŸ¥—",color:"#22c55e"}]),n=S([{id:"user_challenge_001",challengeId:"challenge_001",startDate:"2024-03-10",progress:5,status:"in_progress",completedDays:[1,2,3,4,5],lastCheckInDate:"2024-03-15",dailyCheckIns:["2024-03-11","2024-03-12","2024-03-13","2024-03-14","2024-03-15"]},{id:"user_challenge_002",challengeId:"challenge_003",startDate:"2024-03-14",progress:1,status:"in_progress",completedDays:[1],lastCheckInDate:"2024-03-14",dailyCheckIns:["2024-03-14"]}]),C=f(()=>{const a=n.value.map(s=>s.challengeId);return _.value.filter(s=>!a.includes(s.id))}),g=f(()=>n.value.filter(a=>a.status==="in_progress").map(a=>{const s=_.value.find(e=>e.id===a.challengeId);return{...a,challenge:s}})),k=f(()=>n.value.filter(a=>a.status==="completed").map(a=>{const s=_.value.find(e=>e.id===a.challengeId);return{...a,challenge:s}})),I=f(()=>{if(g.value.length===0)return 0;const a=g.value.reduce((s,e)=>s+e.progress/e.challenge.duration*100,0);return Math.round(a/g.value.length)});return{challenges:_,userChallenges:n,availableChallenges:C,activeChallenges:g,completedChallenges:k,totalProgress:I,joinChallenge:a=>{if(n.value.find(d=>d.challengeId===a))return{success:!1,message:"æ‚¨å·²ç»å‚åŠ æ­¤æŒ‘æˆ˜"};const e={id:`user_challenge_${Date.now()}`,challengeId:a,startDate:new Date().toISOString().split("T")[0],progress:0,status:"in_progress",completedDays:[],lastCheckInDate:null,dailyCheckIns:[]};return n.value.push(e),{success:!0,data:e}},updateChallengeProgress:a=>{const s=n.value.find(h=>h.id===a);if(!s||s.status!=="in_progress")return{success:!1,message:"æŒ‘æˆ˜ä¸å­˜åœ¨æˆ–å·²ç»“æŸ"};const e=_.value.find(h=>h.id===s.challengeId),d=new Date().toISOString().split("T")[0];if(s.lastCheckInDate===d)return{success:!1,message:"ä»Šæ—¥å·²æ‰“å¡ï¼Œè¯·æ˜å¤©å†æ¥ï¼"};s.lastCheckInDate=d,s.dailyCheckIns.push(d);const x=s.dailyCheckIns.length;return!s.completedDays.includes(x)&&(s.completedDays.push(x),s.progress=s.completedDays.length,s.progress>=e.duration)?(s.status="completed",{success:!0,completed:!0,reward:e.reward}):{success:!0,completed:!1}},quitChallenge:a=>{const s=n.value.findIndex(e=>e.id===a);return s>-1?(n.value.splice(s,1),!0):!1},getChallengeById:a=>_.value.find(s=>s.id===a)}}),F={class:"challenges"},L={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},H={class:"eco-card p-6 text-center"},J={class:"text-2xl font-bold text-eco-dark"},K={class:"eco-card p-6 text-center"},R={class:"text-2xl font-bold text-eco-dark"},G={class:"eco-card p-6 text-center"},Q={class:"text-2xl font-bold text-eco-dark"},W={class:"eco-card p-6 text-center"},X={class:"text-2xl font-bold text-eco-dark"},Y={key:0,class:"text-center py-12"},Z={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ee={class:"flex items-center gap-3 mb-4"},te={class:"text-2xl"},se={class:"font-semibold text-eco-dark"},le={class:"text-sm text-gray-600"},ae={class:"mt-4"},ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},oe={class:"flex items-center gap-3 mb-4"},ie={class:"text-2xl"},de={class:"font-semibold text-eco-dark"},re={class:"text-gray-600 text-sm mb-4"},ce={class:"flex items-center gap-2 text-sm text-gray-500 mb-4"},ue={key:0,class:"text-center py-12"},ge={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},pe={class:"text-center"},me={class:"font-semibold text-eco-dark"},_e={class:"text-sm text-eco-green mt-2"},he={__name:"Challenges",setup(_){const n=A(),C=O(),g=S("available"),k=f(()=>n.completedChallenges.reduce((s,e)=>{var d,x;return s+(((x=(d=e.challenge)==null?void 0:d.reward)==null?void 0:x.points)||0)},0)),I=s=>({easy:"success",medium:"warning",hard:"danger"})[s]||"info",P=s=>({easy:"ç®€å•",medium:"ä¸­ç­‰",hard:"å›°éš¾"})[s]||"æœªçŸ¥",T=()=>{g.value="available"},M=s=>{const e=n.joinChallenge(s.id);e.success?(v.success("æˆåŠŸå‚åŠ æŒ‘æˆ˜ï¼"),g.value="active"):v.error(e.message||"å‚åŠ æŒ‘æˆ˜å¤±è´¥")},y=s=>{const e=new Date().toISOString().split("T")[0];return s.lastCheckInDate===e},a=s=>{const e=n.updateChallengeProgress(s.id);e.success?e.completed?(v.success("ğŸ‰ æ­å–œå®ŒæˆæŒ‘æˆ˜ï¼"),C.addPoints(e.reward.points)):v.success("ä»Šæ—¥æ‰“å¡æˆåŠŸï¼"):v.error(e.message||"æ›´æ–°è¿›åº¦å¤±è´¥")};return(s,e)=>{const d=m("el-button"),x=m("el-progress"),h=m("el-tab-pane"),V=m("el-tag"),B=m("Calendar"),U=m("el-icon"),z=m("User"),j=m("el-tabs");return c(),r("div",F,[e[15]||(e[15]=t("div",{class:"mb-6"},[t("h1",{class:"text-3xl font-bold text-eco-dark mb-2"},"ç¯ä¿æŒ‘æˆ˜ä¸­å¿ƒ"),t("p",{class:"text-gray-600"},"å‚ä¸ç¯ä¿æŒ‘æˆ˜ï¼Œå…»æˆç»¿è‰²ç”Ÿæ´»ä¹ æƒ¯")],-1)),t("div",L,[t("div",H,[e[1]||(e[1]=t("div",{class:"text-3xl mb-2"},"ğŸ†",-1)),t("div",J,o(p(n).completedChallenges.length),1),e[2]||(e[2]=t("div",{class:"text-sm text-gray-600"},"å·²å®ŒæˆæŒ‘æˆ˜",-1))]),t("div",K,[e[3]||(e[3]=t("div",{class:"text-3xl mb-2"},"ğŸ¯",-1)),t("div",R,o(p(n).activeChallenges.length),1),e[4]||(e[4]=t("div",{class:"text-sm text-gray-600"},"è¿›è¡Œä¸­æŒ‘æˆ˜",-1))]),t("div",G,[e[5]||(e[5]=t("div",{class:"text-3xl mb-2"},"ğŸ”¥",-1)),t("div",Q,o(p(n).totalProgress)+"% ",1),e[6]||(e[6]=t("div",{class:"text-sm text-gray-600"},"æ€»ä½“è¿›åº¦",-1))]),t("div",W,[e[7]||(e[7]=t("div",{class:"text-3xl mb-2"},"ğŸ’",-1)),t("div",X,o(k.value),1),e[8]||(e[8]=t("div",{class:"text-sm text-gray-600"},"ç´¯è®¡å¥–åŠ±ç§¯åˆ†",-1))])]),i(j,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),class:"mb-8"},{default:u(()=>[i(h,{label:"è¿›è¡Œä¸­",name:"active"},{default:u(()=>[p(n).activeChallenges.length===0?(c(),r("div",Y,[e[10]||(e[10]=t("div",{class:"text-6xl mb-4"},"ğŸ˜´",-1)),e[11]||(e[11]=t("p",{class:"text-gray-600 text-lg"},"æš‚æ— è¿›è¡Œä¸­çš„æŒ‘æˆ˜",-1)),i(d,{type:"primary",class:"mt-4",onClick:T},{default:u(()=>[...e[9]||(e[9]=[b(" å»å‘ç°æ–°æŒ‘æˆ˜ ",-1)])]),_:1})])):(c(),r("div",Z,[(c(!0),r(w,null,D(p(n).activeChallenges,l=>(c(),r("div",{key:l.id,class:"eco-card p-6"},[t("div",ee,[t("span",te,o(l.challenge.icon),1),t("div",null,[t("h3",se,o(l.challenge.title),1),t("p",le,o(l.progress)+"/"+o(l.challenge.duration)+" å¤© ",1)])]),i(x,{percentage:l.progress/l.challenge.duration*100,color:l.challenge.color,"show-text":!1},null,8,["percentage","color"]),t("div",ae,[i(d,{size:"small",type:"primary",onClick:E=>a(l),disabled:y(l),class:$({"opacity-50 cursor-not-allowed":y(l)})},{default:u(()=>[b(o(y(l)?"âœ“ å·²æ‰“å¡":"ä»Šæ—¥æ‰“å¡"),1)]),_:2},1032,["onClick","disabled","class"])])]))),128))]))]),_:1}),i(h,{label:"å¯å‚åŠ ",name:"available"},{default:u(()=>[t("div",ne,[(c(!0),r(w,null,D(p(n).availableChallenges,l=>(c(),r("div",{key:l.id,class:"eco-card p-6 hover:shadow-xl transition-shadow"},[t("div",oe,[t("span",ie,o(l.icon),1),t("div",null,[t("h3",de,o(l.title),1),i(V,{type:I(l.difficulty),size:"small"},{default:u(()=>[b(o(P(l.difficulty)),1)]),_:2},1032,["type"])])]),t("p",re,o(l.description),1),t("div",ce,[i(U,null,{default:u(()=>[i(B)]),_:1}),t("span",null,o(l.duration)+" å¤©",1),i(U,null,{default:u(()=>[i(z)]),_:1}),t("span",null,o(l.participants)+" äººå‚ä¸",1)]),i(d,{type:"primary",class:"w-full",onClick:E=>M(l),style:q({backgroundColor:l.color,borderColor:l.color})},{default:u(()=>[...e[12]||(e[12]=[b(" å‚åŠ æŒ‘æˆ˜ ",-1)])]),_:1},8,["onClick","style"])]))),128))])]),_:1}),i(h,{label:"å·²å®Œæˆ",name:"completed"},{default:u(()=>[p(n).completedChallenges.length===0?(c(),r("div",ue,[...e[13]||(e[13]=[t("div",{class:"text-6xl mb-4"},"ğŸ…",-1),t("p",{class:"text-gray-600 text-lg"},"è¿˜æ²¡æœ‰å®Œæˆä»»ä½•æŒ‘æˆ˜",-1)])])):(c(),r("div",ge,[(c(!0),r(w,null,D(p(n).completedChallenges,l=>(c(),r("div",{key:l.id,class:"eco-card p-6"},[t("div",pe,[e[14]||(e[14]=t("div",{class:"text-2xl mb-2"},"ğŸ‰",-1)),t("h3",me,o(l.challenge.title),1),t("p",_e," å·²å®Œæˆï¼Œè·å¾— "+o(l.challenge.reward.points)+" ç§¯åˆ† ",1)])]))),128))]))]),_:1})]),_:1},8,["modelValue"])])}}};export{he as default};
