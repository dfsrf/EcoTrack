{
  "version": 3,
  "sources": ["../../echarts/lib/data/helper/dataStackHelper.js", "../../echarts/lib/util/vendor.js"],
  "sourcesContent": ["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { each, isString } from 'zrender/lib/core/util.js';\nimport { isSeriesDataSchema } from './SeriesDataSchema.js';\n/**\r\n * Note that it is too complicated to support 3d stack by value\r\n * (have to create two-dimension inverted index), so in 3d case\r\n * we just support that stacked by index.\r\n *\r\n * @param seriesModel\r\n * @param dimensionsInput The same as the input of <module:echarts/data/SeriesData>.\r\n *        The input will be modified.\r\n * @param opt\r\n * @param opt.stackedCoordDimension Specify a coord dimension if needed.\r\n * @param opt.byIndex=false\r\n * @return calculationInfo\r\n * {\r\n *     stackedDimension: string\r\n *     stackedByDimension: string\r\n *     isStackedByIndex: boolean\r\n *     stackedOverDimension: string\r\n *     stackResultDimension: string\r\n * }\r\n */\nexport function enableDataStack(seriesModel, dimensionsInput, opt) {\n  opt = opt || {};\n  var byIndex = opt.byIndex;\n  var stackedCoordDimension = opt.stackedCoordDimension;\n  var dimensionDefineList;\n  var schema;\n  var store;\n  if (isLegacyDimensionsInput(dimensionsInput)) {\n    dimensionDefineList = dimensionsInput;\n  } else {\n    schema = dimensionsInput.schema;\n    dimensionDefineList = schema.dimensions;\n    store = dimensionsInput.store;\n  }\n  // Compatibal: when `stack` is set as '', do not stack.\n  var mayStack = !!(seriesModel && seriesModel.get('stack'));\n  var stackedByDimInfo;\n  var stackedDimInfo;\n  var stackResultDimension;\n  var stackedOverDimension;\n  each(dimensionDefineList, function (dimensionInfo, index) {\n    if (isString(dimensionInfo)) {\n      dimensionDefineList[index] = dimensionInfo = {\n        name: dimensionInfo\n      };\n    }\n    if (mayStack && !dimensionInfo.isExtraCoord) {\n      // Find the first ordinal dimension as the stackedByDimInfo.\n      if (!byIndex && !stackedByDimInfo && dimensionInfo.ordinalMeta) {\n        stackedByDimInfo = dimensionInfo;\n      }\n      // Find the first stackable dimension as the stackedDimInfo.\n      if (!stackedDimInfo && dimensionInfo.type !== 'ordinal' && dimensionInfo.type !== 'time' && (!stackedCoordDimension || stackedCoordDimension === dimensionInfo.coordDim)) {\n        stackedDimInfo = dimensionInfo;\n      }\n    }\n  });\n  if (stackedDimInfo && !byIndex && !stackedByDimInfo) {\n    // Compatible with previous design, value axis (time axis) only stack by index.\n    // It may make sense if the user provides elaborately constructed data.\n    byIndex = true;\n  }\n  // Add stack dimension, they can be both calculated by coordinate system in `unionExtent`.\n  // That put stack logic in List is for using conveniently in echarts extensions, but it\n  // might not be a good way.\n  if (stackedDimInfo) {\n    // Use a weird name that not duplicated with other names.\n    // Also need to use seriesModel.id as postfix because different\n    // series may share same data store. The stack dimension needs to be distinguished.\n    stackResultDimension = '__\\0ecstackresult_' + seriesModel.id;\n    stackedOverDimension = '__\\0ecstackedover_' + seriesModel.id;\n    // Create inverted index to fast query index by value.\n    if (stackedByDimInfo) {\n      stackedByDimInfo.createInvertedIndices = true;\n    }\n    var stackedDimCoordDim_1 = stackedDimInfo.coordDim;\n    var stackedDimType = stackedDimInfo.type;\n    var stackedDimCoordIndex_1 = 0;\n    each(dimensionDefineList, function (dimensionInfo) {\n      if (dimensionInfo.coordDim === stackedDimCoordDim_1) {\n        stackedDimCoordIndex_1++;\n      }\n    });\n    var stackedOverDimensionDefine = {\n      name: stackResultDimension,\n      coordDim: stackedDimCoordDim_1,\n      coordDimIndex: stackedDimCoordIndex_1,\n      type: stackedDimType,\n      isExtraCoord: true,\n      isCalculationCoord: true,\n      storeDimIndex: dimensionDefineList.length\n    };\n    var stackResultDimensionDefine = {\n      name: stackedOverDimension,\n      // This dimension contains stack base (generally, 0), so do not set it as\n      // `stackedDimCoordDim` to avoid extent calculation, consider log scale.\n      coordDim: stackedOverDimension,\n      coordDimIndex: stackedDimCoordIndex_1 + 1,\n      type: stackedDimType,\n      isExtraCoord: true,\n      isCalculationCoord: true,\n      storeDimIndex: dimensionDefineList.length + 1\n    };\n    if (schema) {\n      if (store) {\n        stackedOverDimensionDefine.storeDimIndex = store.ensureCalculationDimension(stackedOverDimension, stackedDimType);\n        stackResultDimensionDefine.storeDimIndex = store.ensureCalculationDimension(stackResultDimension, stackedDimType);\n      }\n      schema.appendCalculationDimension(stackedOverDimensionDefine);\n      schema.appendCalculationDimension(stackResultDimensionDefine);\n    } else {\n      dimensionDefineList.push(stackedOverDimensionDefine);\n      dimensionDefineList.push(stackResultDimensionDefine);\n    }\n  }\n  return {\n    stackedDimension: stackedDimInfo && stackedDimInfo.name,\n    stackedByDimension: stackedByDimInfo && stackedByDimInfo.name,\n    isStackedByIndex: byIndex,\n    stackedOverDimension: stackedOverDimension,\n    stackResultDimension: stackResultDimension\n  };\n}\nfunction isLegacyDimensionsInput(dimensionsInput) {\n  return !isSeriesDataSchema(dimensionsInput.schema);\n}\nexport function isDimensionStacked(data, stackedDim) {\n  // Each single series only maps to one pair of axis. So we do not need to\n  // check stackByDim, whatever stacked by a dimension or stacked by index.\n  return !!stackedDim && stackedDim === data.getCalculationInfo('stackedDimension');\n}\nexport function getStackedDimension(data, targetDim) {\n  return isDimensionStacked(data, targetDim) ? data.getCalculationInfo('stackResultDimension') : targetDim;\n}", "\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { isArray } from 'zrender/lib/core/util.js';\n/* global Float32Array */\nvar supportFloat32Array = typeof Float32Array !== 'undefined';\nvar Float32ArrayCtor = !supportFloat32Array ? Array : Float32Array;\nexport function createFloat32Array(arg) {\n  if (isArray(arg)) {\n    // Return self directly if don't support TypedArray.\n    return supportFloat32Array ? new Float32Array(arg) : arg;\n  }\n  // Else is number\n  return new Float32ArrayCtor(arg);\n}"],
  "mappings": "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",
  "names": []
}
